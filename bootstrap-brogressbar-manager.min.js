
(function(a){a.fn.progressbarManager=function(i){if(!a.fn.progressbarManager.GUID){a.fn.progressbarManager.GUID=1}var f=a.extend({debug:false,currentValue:0,totalValue:100,style:"primary",animate:false,stripe:false,id:"pbm-bootsrap-progress-"+a.fn.progressbarManager.GUID,barIdPrefix:"pbm-progress-bar-",total:i.totalValue,addDefaultBar:true,showValueHandler:function(j){var k=j.elem.attr("aria-valuenow")+"%";j.elem.text(k)},hideValueHandler:function(j){j.elem.text("")},onComplete:function(){},onBarComplete:function(){}},i);var b=a(this);function g(l){var m=this;var o=1;var r={};var n;var p=0;var q=false;var k=d(l);b.append(k);var n="";var j=function(){p=0;for(var s in r){p+=r[s].totalValuePercentRounded}};this.setValue=function(w,u){var t=this.getBar(u);w=parseInt(w);if(t){var v=h(w,f.total);var s=Math.round(v*10)/10;if(w>t.totalValue){c("New Bar value is greater that the totalValue. Setting the bar percentage to full");v=100;s=100;w=t.totalValue}t.elem.attr("aria-valuenow",s);t.currentPercent=v;t.currentPercentRounded=s;t.currentValue=w;t.elem.css("width",s+"%");if(t.showText){this.showValue(u)}if(this.isComplete(u)){f.onBarComplete.call(t)}j();if(this.isComplete()){f.onComplete()}}return this};this.animate=function(t){var s=this.getBar(t);if(s){s.elem.addClass("active")}return this};this.animateRemove=function(t){var s=this.getBar(t);if(s){s.elem.removeClass("active")}return this};this.stripe=function(t){var s=this.getBar(t);if(s){s.elem.addClass("progress-bar-striped")}return this};this.removeStripe=function(t){var s=this.getBar(t);if(s){s.elem.removeClass("progress-bar-striped")}return this};this.style=function(s,u){var t=this.getBar(u);if(t){t.elem.removeClass("progress-bar-"+t.style);t.style=s;t.elem.addClass("progress-bar-"+s)}return this};this.showValue=function(u){var t=this.getBar(u);if(u===true){for(var s in r){s.showText=true;s.showValueHandler(t)}}if(t){t.showText=true;t.showValueHandler(t)}return this};this.hideValue=function(u){var t=this.getBar(u);if(u===true){for(var s in r){s.showText=false;s.hideValueHandler(t)}}if(t){t.showText=false;t.hideValueHandler(t)}return this};this.isComplete=function(t){var s=this.getBar(t);return(s&&s.currentValue>=s.totalValue)};this.complete=function(t){var s=this.getBar(t);if(s){this.setValue(s.totalValue,t)}return this};this.completeAll=function(){var s;for(s in r){m.complete(s)}};this.addBar=function(C){if(q){c("container can not take new bar element, space full!");return false}var w=a.extend({initValue:0,totalValue:100,style:"primary",animate:false,stripe:false,showValueHandler:f.showValueHandler,hideValueHandler:f.hideValueHandler},C);var s=f.barIdPrefix+o;var x=parseInt(w.initValue)||0;var y=parseInt(w.totalValue)||(100-p);var v=h(x,f.total);var t=Math.round(v*10)/10;var A=h(y,f.total);var z=Math.round(A*10)/10;var B=100-p;if(v>=B){v=B;q=true}var u=e(s,t,w.style,x,y,w.animate,w.stripe);k.append(u);r[s]={totalValue:y,currentValue:x,init:x,initPercent:v,totalValuePercent:A,totalValuePercentRounded:z,currentPercent:v,currentPercentRounded:t,style:w.style,elem:u,showText:true,id:s,showValueHandler:w.showValueHandler,hideValueHandler:w.hideValueHandler};w.showValueHandler(r[s]);o++;j();return s};this.removeBar=function(t){var s=this.getBar(t);if(s){s.elem.remove()}};this.destroy=function(){k.remove()};this.getBar=function(s){var t=s||n;if(r[t]){return r[t]}c("No progress bar element with id: "+t);return null};if(f.addDefaultBar){n=this.addBar(f)}}var d=function(j){return a("<div></div>",{id:j,"class":"progress"})};var e=function(l,p,k,o,q,m,r){var n=a("<div></div>");var j="progress-bar progress-bar-"+k;if(m){j+=" active "}if(r){j+=" progress-bar-striped"}n.attr("id",l).attr("role","progress-bar");n.attr("aria-valuenow",p).attr("aria-valuemin",o);n.attr("aria-valuemax",q).css({width:p+"%","min-width":"2em",});k;n.addClass(j);n.append('<span class="sr-only sr-indicator">'+p+"% Complete</span></div>");return n};var h=function(k,j){return 100-(j-k)/j*100};var c=function(j){if(f.debug){console.log("Progress Bar Manager Debug => "+j)}};a.fn.progressbarManager.GUID++;return new g(f.id)}}(jQuery));